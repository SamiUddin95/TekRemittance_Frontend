<div class="">
    <div class="row">
        <div class="col-12">
            @if (isLoading) {
                <div class="text-center py-5">
                    <div class="spinner-border text-primary" role="status">
                        <span class="visually-hidden">Loading...</span>
                    </div>
                </div>
            } @else {
                <app-page-title [title]="getPageTitle()" subTitle="Acquisition Management"></app-page-title>
                <form [formGroup]="agentForm" (ngSubmit)="onSubmit()">
                <div class="card shadow-sm">
                    <div class="card-header bg-light text-white">
                        <div class="d-flex align-items-center">
                            <ng-icon name="tablerUserPlus" class="me-2 gradient-icon" size="20"></ng-icon>
                            <h4 class="card-title mb-0 text-dark">Basic Information</h4>
                        </div>
                    </div>
                    <div class="card-body p-4">
                            <div class="row g-4">
                                <div class="col-lg-3">
                                    <div class="form-group">
                                        <label for="code" class="form-label fw-semibold">
                                            <ng-icon name="tablerCode" class="me-1 gradient-icon" size="16"></ng-icon>
                                            Code <span class="text-danger">*</span>
                                        </label>
                                        <input type="text" id="code" class="form-control form-control" [class.is-invalid]="isFieldInvalid('code')" formControlName="code" placeholder="Enter agent code" maxlength="20">
                                        @if (isFieldInvalid('code')) { <div class="invalid-feedback">{{ getFieldError('code') }}</div> }
                                    </div>
                                </div>
                                <div class="col-lg-3">
                                    <div class="form-group">
                                        <label for="name" class="form-label fw-semibold">
                                            <ng-icon name="tablerUser" class="me-1 gradient-icon" size="16"></ng-icon>
                                            Agent Name <span class="text-danger">*</span>
                                        </label>
                                        <input type="text" id="name" class="form-control form-control" [class.is-invalid]="isFieldInvalid('name')" formControlName="name" placeholder="Enter agent name" maxlength="100">
                                        @if (isFieldInvalid('name')) { <div class="invalid-feedback">{{ getFieldError('name') }}</div> }
                                    </div>
                                </div>
                                <div class="col-lg-3">
                                    <div class="form-group">
                                        <label for="phone1" class="form-label fw-semibold">
                                            <ng-icon name="tablerPhone" class="me-1 gradient-icon" size="16"></ng-icon>
                                            Phone # 1
                                        </label>
                                        <input type="text" id="phone1" class="form-control form-control" [class.is-invalid]="isFieldInvalid('phone1')" formControlName="phone1" placeholder="Enter Phone 1" maxlength="20">
                                    </div>
                                </div>
                                <div class="col-lg-3">
                                    <div class="form-group">
                                        <label for="phone2" class="form-label fw-semibold">
                                            <ng-icon name="tablerPhone" class="me-1 gradient-icon" size="16"></ng-icon>
                                            Phone # 2
                                        </label>
                                        <input type="text" id="phone2" class="form-control form-control" [class.is-invalid]="isFieldInvalid('phone2')" formControlName="phone2" placeholder="Enter Phone 2" maxlength="20">
                                    </div>
                                </div>
                                <div class="col-lg-3">
                                    <div class="form-group">
                                        <label for="fax" class="form-label fw-semibold">
                                            <ng-icon name="tablerPrinter" class="me-1 gradient-icon" size="16"></ng-icon>
                                            Fax
                                        </label>
                                        <input type="text" id="fax" class="form-control form-control" [class.is-invalid]="isFieldInvalid('fax')" formControlName="fax" placeholder="Enter fax number" maxlength="20">
                                    </div>
                                </div>
                                <div class="col-lg-3">
                                    <div class="form-group">
                                        <label for="email" class="form-label fw-semibold">
                                            <ng-icon name="tablerMail" class="me-1 gradient-icon" size="16"></ng-icon>
                                            Email
                                        </label>
                                        <input type="email" id="email" class="form-control form-control" [class.is-invalid]="isFieldInvalid('email')" formControlName="email" placeholder="e.g., agent@example.com" maxlength="255">
                                        @if (isFieldInvalid('email')) { <div class="invalid-feedback">{{ getFieldError('email') }}</div> }
                                    </div>
                                </div>
                            </div>
                    </div>
                </div>

                <div class="card shadow-sm mt-3">
                    <div class="card-header bg-light text-white">
                        <div class="d-flex align-items-center">
                            <ng-icon name="tablerMapPin" class="me-2 gradient-icon" size="20"></ng-icon>
                            <h4 class="card-title mb-0 text-dark">Location Details</h4>
                        </div>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-4">
                            <div class="col-lg-6">
                                <label class="form-label fw-semibold">
                                    <ng-icon name="tablerMapPin" class="me-1 gradient-icon" size="16"></ng-icon>
                                    Address
                                </label>
                                <input class="form-control" formControlName="address" placeholder="Enter full address" />
                            </div>
                            <div class="col-lg-2">
                                <label class="form-label fw-semibold">
                                    <ng-icon name="tablerWorld" class="me-1 gradient-icon" size="16"></ng-icon>
                                    Country
                                </label>
                                <select class="form-select" formControlName="countryId">
                                    <option value="">Select Country</option>
                                    <option *ngFor="let c of countries" [value]="c.id">{{ c.name }}</option>
                                </select>
                            </div>
                            <div class="col-lg-2">
                                <label class="form-label fw-semibold">
                                    <ng-icon name="tablerMapPin" class="me-1 gradient-icon" size="16"></ng-icon>
                                    Province
                                </label>
                                <select class="form-select" formControlName="provinceId">
                                    <option value="">Select Province</option>
                                    <option *ngFor="let p of provinces" [value]="p.id">{{ p.name }}</option>
                                </select>
                            </div>
                            <div class="col-lg-2">
                                <label class="form-label fw-semibold">
                                    <ng-icon name="tablerBuilding" class="me-1 gradient-icon" size="16"></ng-icon>
                                    City
                                </label>
                                <select class="form-select" formControlName="cityId">
                                    <option value="">Select City</option>
                                    <option *ngFor="let c of cities" [value]="c.id">{{ c.name }}</option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm mt-3">
                    <div class="card-header bg-light text-white">
                        <div class="d-flex align-items-center">
                            <ng-icon name="tablerSettings" class="me-2 gradient-icon" size="20"></ng-icon>
                            <h4 class="card-title mb-0 text-dark">Operational Preferences</h4>
                        </div>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-4">
                            <div class="col-lg-2">
                                <label class="form-label fw-semibold">
                                    <ng-icon name="tablerClock" class="me-1 gradient-icon" size="16"></ng-icon>
                                    Cut off Time Start
                                </label>
                                <input class="form-control" type="time" formControlName="cutOffStart" />
                            </div>
                            <div class="col-lg-2">
                                <label class="form-label fw-semibold">
                                    <ng-icon name="tablerClock" class="me-1 gradient-icon" size="16"></ng-icon>
                                    Cut off Time End
                                </label>
                                <input class="form-control" type="time" formControlName="cutOffEnd" />
                            </div>
                            <div class="col-lg-3">
                                <div>
                                    <label class="form-label fw-semibold">
                                        <ng-icon name="tablerHash" class="me-1 gradient-icon" size="16"></ng-icon>
                                        XPin Generation
                                    </label>
                                    <div class="d-flex gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" formControlName="brnByApplication" id="brnByApplication">
                                            <label for="brnByApplication" class="form-check-label">by Application</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" formControlName="brnByAgent" id="brnByAgent">
                                            <label for="brnByAgent" class="form-check-label">by Agent</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="col-lg-3">
                                <div>
                                    <label class="form-label fw-semibold">
                                        <ng-icon name="tablerSettings" class="me-1 gradient-icon" size="16"></ng-icon>
                                        Process
                                    </label>
                                    <div class="d-flex gap-3">
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" formControlName="autoProcess" id="autoProcess">
                                            <label for="autoProcess" class="form-check-label">Auto Process</label>
                                        </div>
                                        <div class="form-check">
                                            <input class="form-check-input" type="checkbox" formControlName="manualProcess" id="manualProcess">
                                            <label for="manualProcess" class="form-check-label">Manual Process</label>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm mt-3">
                    <div class="card-header bg-light text-white">
                        <div class="d-flex align-items-center">
                            <ng-icon name="tablerPlugConnected" class="me-2 gradient-icon" size="20"></ng-icon>
                            <h4 class="card-title mb-0 text-dark">Acquisition Modes</h4>
                        </div>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-3">
                            <div class="col-lg-12 d-flex flex-wrap gap-4">
                                <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isOnlineAllow" id="isOnlineAllow"><label class="form-check-label ms-2" for="isOnlineAllow">Is On Line Allow</label></div>
                                <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isFileUploadAllow" id="isFileUploadAllow"><label class="form-check-label ms-2" for="isFileUploadAllow">Is File Upload Allow</label></div>
                                <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isFtpAllow" id="isFtpAllow"><label class="form-check-label ms-2" for="isFtpAllow">Is FTP Allow</label></div>
                                <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isEmailUploadAllow" id="isEmailUploadAllow"><label class="form-check-label ms-2" for="isEmailUploadAllow">Is Email Upload Allow</label></div>
                                <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isWebServiceAllow" id="isWebServiceAllow"><label class="form-check-label ms-2" for="isWebServiceAllow">Is Web Service Allow</label></div>
                                <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isBeneficiarySmsAllow" id="isBeneficiarySmsAllow"><label class="form-check-label ms-2" for="isBeneficiarySmsAllow">Is Beneficiary SMS Allow</label></div>
                                <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isActive" id="isActive"><label class="form-check-label ms-2" for="isActive">Is Active</label></div>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm mt-3">
                    <div class="card-header bg-light text-white">
                        <div class="d-flex align-items-center">
                            <ng-icon name="tablerCurrencyDollar" class="me-2 gradient-icon" size="20"></ng-icon>
                            <h4 class="card-title mb-0 text-dark">Disbursement Modes</h4>
                        </div>
                    </div>
                    <div class="card-body p-4">
                        <div class="col-lg-12 d-flex flex-wrap gap-4">
                            <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isOtcAllow" id="isOtcAllow"><label class="form-check-label ms-2" for="isOtcAllow">Is COT Allow</label></div>
                            <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isDirectCreditAllow" id="isDirectCreditAllow"><label class="form-check-label ms-2" for="isDirectCreditAllow">Is Direct Credit Allow</label></div>
                            <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isOtherCreditAllow" id="isOtherCreditAllow"><label class="form-check-label ms-2" for="isOtherCreditAllow">Is Other Credit Allow</label></div>
                            <div class="form-check"><input class="form-check-input" type="checkbox" formControlName="isRemitterSmsAllow" id="isRemitterSmsAllow"><label class="form-check-label ms-2" for="isRemitterSmsAllow">Is Remitter SMS Allow</label></div>
                        </div>
                    </div>
                </div>

                <div class="card shadow-sm mt-3">
                    <div class="card-header bg-light text-white">
                        <div class="d-flex align-items-center">
                            <ng-icon name="tablerLink" class="me-2 gradient-icon" size="20"></ng-icon>
                            <h4 class="card-title mb-0 text-dark">Direct Integration</h4>
                        </div>
                    </div>
                    <div class="card-body p-4">
                        <div class="row g-4">
                            <div class="col-lg-12">
                                <div class="form-check mb-3">
                                    <input class="form-check-input" type="checkbox" formControlName="directIntegration" id="directIntegration">
                                    <label class="form-check-label ms-2" for="directIntegration">Direct Integration</label>
                                </div>
                            </div>

                            @if (agentForm.get('directIntegration')?.value) {
                                <div class="col-lg-4">
                                    <label class="form-label fw-semibold">
                                        <ng-icon name="tablerHelp" class="me-1 gradient-icon" size="16"></ng-icon>
                                        Inquiry URL <span class="text-danger">*</span>
                                    </label>
                                    <input class="form-control" formControlName="inquiryUrl" placeholder="Enter Inquiry URL" />
                                </div>
                                <div class="col-lg-4">
                                    <label class="form-label fw-semibold">
                                        <ng-icon name="tablerCreditCard" class="me-1 gradient-icon" size="16"></ng-icon>
                                        Payment URL <span class="text-danger">*</span>
                                    </label>
                                    <input class="form-control" formControlName="paymentUrl" placeholder="Enter Payment URL" />
                                </div>
                                <div class="col-lg-4">
                                    <label class="form-label fw-semibold">
                                        <ng-icon name="tablerLockOpen" class="me-1 gradient-icon" size="16"></ng-icon>
                                        Unlock URL
                                    </label>
                                    <input class="form-control" formControlName="unlockUrl" placeholder="Enter Unlock URL" />
                                </div>
                            }
                        </div>
                        <div class="d-flex justify-content-end gap-2 mt-4">
                            <button type="button" class="btn btn-dark" (click)="onCancel()" [disabled]="isSubmitting">
                                <ng-icon name="tablerArrowLeft" class="me-1" size="16"></ng-icon>
                                Back to List
                            </button>
                            <button type="submit" class="btn submit-button" (click)="onSubmit()">
                                @if (isSubmitting) {
                                    <span class="spinner-border spinner-border-sm me-1" role="status"></span>
                                    Saving...
                                } @else {
                                    <ng-icon name="tablerDeviceFloppy" class="me-1" size="16"></ng-icon>
                                    Save
                                }
                            </button>
                        </div>
                    </div>
                </div>
                </form>
            }
        </div>
    </div>
</div>
